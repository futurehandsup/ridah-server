<% include ../templates/head.ejs %>
<div class="container" style="padding-top: 80px;">
  <ul class="pagination justify-content-center text-center">
    <li class="page-item">
      <%
      var m_date = new Date(calendar.date);
      m_date.setMonth(m_date.getMonth()-1);
      %>
      <% var prev_date = m_date.getFullYear() + "-" + (m_date.getMonth()+1) + "-" + m_date.getDate();%>
      <a class="page-link" href="daily?type=monthly&date=<%=prev_date%>" aria-label="Previous">
      <span aria-hidden="true">&laquo;</span>
      <span class="sr-only">Previous</span>
      </a>
    </li>
    <h2 class="text-center" style="">
      <%=calendar.date.getFullYear()%>년 <%=calendar.date.getMonth()+1%>월
    </h2>
    <li class="page-item">
      <% m_date.setMonth(m_date.getMonth()+2);%>
      <% var next_date = m_date.getFullYear() + "-" + (m_date.getMonth()+1) + "-" + m_date.getDate();%>
      <a class="page-link" href="daily?type=monthly&date=<%=next_date%>" aria-label="Next">
        <span aria-hidden="true">&raquo;</span>
        <span class="sr-only">Next</span>
      </a>
    </li>
  </ul>

  <table class="table table-bordered">
    <% var dates = ["일", "월", "화", "수", "목", "금", "토"]%>
    <thead class="thead-light">
      <tr>
      <% for(date in dates){%>
        <th scope="col"><%=dates[date]%></th>
      <%}%>
      </tr>
    </thead>
    <tbody>
    <% for(var i=0; i < calendar.schedules.length; i++){ %>
      <%
      var schedule = calendar.schedules[i];
      var m = schedule.date.getDay();
      %>
      <% if(i==0){ %>
        <tr>
          <%for(var j=0; j<m; j++){ %>
          <td></td>
          <% } %>
      <% } else if(m%7 == 0){%><tr><%}%>
        <% var today = new Date();%>
      <td <%if(schedule.date.getFullYear() == today.getFullYear() && schedule.date.getMonth() == today.getMonth() && schedule.date.getDate() == today.getDate()){%>class="table-primary"<%}%>>
        <%=schedule.date.getDate()%><br>
        <%for (var j=0; j < schedule.programs.length; j++){%>
        <% var program = schedule.programs[j];%>
          <%if(program.isReserved){%><span class="badge badge-primary">예</span><%} else {%><span class="badge badge-success">가</span><%}%>
          <strong><%=program.time.start_at%></strong> <%=program.programname%> <br>
        <% } %>
      </td>
      <% if(i==calendar.schedules.length-1){
          for(var j=m; j < 6; j++){
      %>
          <td></td>
          <% } %>
        </tr>
      <% } else if(m%7 == 6){%> </tr> <%}%>
    <% } %>
    </tbody>
  </table>
</div>
<% include ../templates/bottom.ejs %>
