<% include ../templates/head.ejs %>
<section style="background-color: #fafafa;">
  <div class="jumbotron-fluid" style="background-image:url('<%=store.image%>');background-position: center; min-height: 200px;padding: 100px 15px; margin-bottom: 20px;">
    <div class="container">

    </div>
  </div>
  <div class="container">
    <div class="card" style="margin-bottom: 20px;">
      <div class="card-header">
        정보
      </div>
      <div class="card-body">
        <h4 class="card-title"><%=store.storename%></h4>
        <h6 class="card-subtitle mb-2 text-muted"><%=store.address%></h6>
        <p class="card-text"><%=store.introduction%></p>
        <a href="#" class="card-link"><%=store.telephone%></a>
        <a href="#" class="card-link"><%=store.website%></a>
      </div>
    </div>

    <div class="card" style="margin-bottom: 20px;">
      <div class="card-header">
        <%var date=calendar.schedules[0].date;%>
        <%=date.getFullYear()%>년 <%=(date.getMonth()+1)%>월 <%=date.getDate()%>일 프로그램
        <a href="" class="card-link float-right">날짜 변경</a>
      </div>
      <ul class="list-group list-group-flush">
        <% for(var i=0; i<calendar.schedules[0].programs.length; i++){%>
          <% var program = calendar.schedules[0].programs[i]; %>
          <li class="list-group-item">
            <%var dateString = date.getFullYear()+"-"+(date.getMonth()+1)+"-"+date.getDate()%>
              <%if(program.isReserved){ %>
              <span class="text-danger pull-right">예약 불가</span>
              <%}else{%>
                <a href="/customers/programs/<%=program.id%>?date=<%=dateString%>&userId=<%=user.id%>">
                  <span class="pull-right">예약하기</span>
                </a>
              <%}%>
              <%=program.time.start_at%>
              <h5><%=program.programname%></h5>
          </li>
        <%}%>
      </ul>
    </div>

    <div class="card" style="margin-bottom: 20px;">
      <div class="card-header">
        리뷰 <%=reviews.length%>개
        <a href="/customers/stores/<%=store.id%>/reviews/list?userId=<%=user.id%>&reviewType=review" class="card-link float-right">더보기</a>
      </div>
      <ul class="list-group list-group-flush">
        <%if(reviews.length == 0){%>
          <li class="list-group-item">후기가 없습니다</li>
        <%}%>
        <% for(var i=0; i<reviews.length; i++){%>
          <% var review = reviews[i]; %>
          <li class="list-group-item">
            <div class="d-flex w-100 justify-content-between">
              <h5 class="mb-1"><%=review.reviewTitle%></h5>
              <small><%=review.reviewWriter.username%>님, <%=review.created_at.getFullYear()%>년 <%=(review.created_at.getMonth()+1)%>월 <%=review.created_at.getDate()%>일</small>
            </div>
            <p class="mb-1"><%=review.reviewText%></p>
          </li>
        <%} %>
      </ul>
    </div>

    <div class="card" style="margin-bottom: 20px;">
      <div class="card-header">
        문의 <%=qnas.length%>개
        <a href="/customers/stores/<%=store.id%>/qnas/list?userId=<%=user.id%>&qnaType=qna" class="card-link float-right">더보기</a>
      </div>
      <ul class="list-group list-group-flush">
        <%if(qnas.length == 0){%>
          <li class="list-group-item">문의가 없습니다</li>
        <%}%>
        <% for(var i=0; i<qnas.length; i++){%>
          <% var qna = qnas[i]; %>
          <li class="list-group-item">
            <div class="d-flex w-100 justify-content-between">
              <h5 class="mb-1"><%=qna.qnaTitle%></h5>
              <small><%=qna.qnaWriter.username%>님, <%=qna.created_at.getFullYear()%>년 <%=(qna.created_at.getMonth()+1)%>월 <%=qna.created_at.getDate()%>일</small>
            </div>
            <p class="mb-1"><%=qna.qnaText%></p>
            <small><%=qna.qnaWriter.username%>님</small>
          </li>
        <%} %>
      </ul>
    </div>
  </div>
</section>
<% include ../templates/bottom.ejs %>
